<?php
class Property_Modal extends CI_Model{	/* function fetch_prop_mobile_and_next($txt_mobile,$txt_addi_mobile)    {				$query = $this->db->query("SELECT id as prop_id FROM property where phone='".$txt_mobile."'");		return $query->result();    } */	function fetch_dynamic_fields_mdl()    {		        $sql = "select * from dynamic_fields";		$query = $this->db->query($sql);		return $query->result();    }		function fetch_property_details_by_id($prop_id)    {		        $sql = "select * from property where id = '$prop_id'";		$query = $this->db->query($sql);		return $query->result();    }	    function get_ResidencialProperty_count($search_all)    {		        $sql = "select * from property where location like '%$search_all%'";        $query = $this->db->query($sql);        return $query->num_rows();    }	    function fetch_ResidencialProperty($limit, $start, $search_all)    {				if ($search_all == "NULL") $search_all = "";		// $sql = "SELECT *,city.city_name as cityName FROM property,city WHERE property.city_name=city.city_id and property_title like '%$search_all%' order by id DESC limit " . $start . ", " . $limit;		$sql = "SELECT * FROM property WHERE location like '%$search_all%' order by id limit " . $start . ", " . $limit;		$query = $this->db->query($sql);		return $query->result();    }				    function check_mob_exist($txt_mobile)    {				$query = $this->db->query("SELECT * FROM property where phone='".$txt_mobile."'");        return $query->result();		    }		    function fetch_prop_mobile_and_next($txt_mobile,$txt_addi_mobile)    {				$query = $this->db->query("SELECT id as prop_id FROM property where phone='".$txt_mobile."'");		return $query->result();    }		    function save_prop_mobile_and_next($txt_mobile,$txt_addi_mobile)    {				$query = $this->db->query("insert into property	(phone,exphone) values('".$txt_mobile."','".$txt_addi_mobile."')");		if ($query !== FALSE)		{			$query = $this->db->query("SELECT id as prop_id FROM property where phone='".$txt_mobile."'");			return $query->result();		}		else		{			return "Property has not been Updated";		}		    }    function update_property_do($ownership,$location,$phone,$exphone,$pincode,$paddress,$cost,$bhk,$furnishing,$floornumbers,$food,$religion,$agent,$propertycategory,$propertytype,$handleby,$occupation,$bcondition,$facing,$areasize,$security_amt,$majority,$yesno,$chk1,$aboutproperty,$datevacant,$chk_mark_alloted,$dateallot,$dateexpectvac,$checked_aminities,$prop_id,$file_property)    {				$query = $this->db->query("UPDATE property set ownership='".$ownership."',location='".$location."',phone='".$phone."',exphone='".$exphone."',pincode='".$pincode."',paddress='".$paddress."',cost='".$cost."',bhk='".$bhk."',furnishing='".$furnishing."',floornumbers='".$floornumbers."',food='".$food."',religion='".$religion."',agent='".$agent."',propertycategory='".$propertycategory."',propertytype='".$propertytype."',handleby='".$handleby."',occupation='".$occupation."',bcondition='".$bcondition."',facing='".$facing."',areasize='".$areasize."',security_amt='".$security_amt."',majority='".$majority."',aboutproperty='".$aboutproperty."',datevacant='".$datevacant."',vacant='".$chk_mark_alloted."',dateallot='".$dateallot."',dateexpectvac='".$dateexpectvac."',amenities='".$checked_aminities."',image='".$file_property."' WHERE id='".$prop_id."'");		if ($query !== FALSE)		{			return "Property has been Updated...";		}		else		{			return "Property has not been Updated";		}    }	    function update_property_no_img_do($ownership,$location,$phone,$exphone,$pincode,$paddress,$cost,$bhk,$furnishing,$floornumbers,$food,$religion,$agent,$propertycategory,$propertytype,$handleby,$occupation,$bcondition,$facing,$areasize,$security_amt,$majority,$yesno,$chk1,$aboutproperty,$datevacant,$chk_mark_alloted,$dateallot,$dateexpectvac,$checked_aminities,$prop_id)    {				$query = $this->db->query("UPDATE property set ownership='".$ownership."',location='".$location."',phone='".$phone."',exphone='".$exphone."',pincode='".$pincode."',paddress='".$paddress."',cost='".$cost."',bhk='".$bhk."',furnishing='".$furnishing."',floornumbers='".$floornumbers."',food='".$food."',religion='".$religion."',agent='".$agent."',propertycategory='".$propertycategory."',propertytype='".$propertytype."',handleby='".$handleby."',occupation='".$occupation."',bcondition='".$bcondition."',facing='".$facing."',areasize='".$areasize."',security_amt='".$security_amt."',majority='".$majority."',aboutproperty='".$aboutproperty."',datevacant='".$datevacant."',chk_mark_alloted='".$chk_mark_alloted."',dateallot='".$dateallot."',dateexpectvac='".$dateexpectvac."',checked_aminities='".$checked_aminities."' WHERE id='".$prop_id."'");		if ($query !== FALSE)		{			return "1";			// return "UPDATE property set property_title='".$txt_name."',religion='".$religion."',address='".$txt_prop_address."',occupation='".$txt_occupation."',food='".$slt_Food."',propertytype='".$propertytype."',propertycategory='".$prop_category."',cost='".$txt_rent_cost."',security_amt='".$txt_security_amt."',location='".$slt_location."',floornumbers='".$slt_Floor."',bhk='".$slt_bhk."',majority='".$txt_majority_perticul."',furnishing='".$slt_Furnishing."',aboutproperty='".$more_info_txtarea."',facing='".$facingdirection."',bcondition='".$buildingcondition."',paddress='".$txt_prop_address1."',pincode='".$txt_pincode."',agent='".$txt_agent."',city_name='".$slt_city."',vacant='".$chk_mark_alloted."',datevacant='".$date_from_vacent."',dateallot='".$txt_mark_alloted."',dateexpectvac='".$txt_Expected_vacant."',cdate='',ctime='' WHERE id='".$prop_id."'";		}		else		{			return "Property has not been Updated";		}    }			protected $table = 'location';    function get_locality_count($search_all)    {		        $sql = "select * from location where location_name like '%$search_all%'";        $query = $this->db->query($sql);        return $query->num_rows();				 // return $this->db->count_all($this->table);    }					public function get_localities($limit, $start) {        $this->db->limit($limit, $start);        $query = $this->db->get($this->table);        return $query->result();    }					    function fetch_locality_pagination($limit, $start, $search_all)    {				if ($search_all == "NULL") $search_all = "";		$sql = "SELECT * FROM location,city WHERE location.city_id=city.city_id and location_name like '%$search_all%' order by location_id DESC limit " . $start . ", " . $limit;		$query = $this->db->query($sql);		return $query->result();    }							    function get_all_localities_mdl()    {				$query = $this->db->query("SELECT * FROM location,city WHERE location.city_id=city.city_id order by location_id DESC");        return $query->result();		    }		    function btn_update_city($txt_city,$txt_city_id)    {				$query = $this->db->query("UPDATE city set city_name='".$txt_city."' WHERE city_id='".$txt_city_id."'");		if ($query !== FALSE)		{			return "City has been Updated...";			// success so access your result		}		else		{			return "City has not been Updated";			// do something with $this->db->error()		}        // return $query->result();		    }							    function update_locality($txt_city,$txt_locality,$txt_locality_id)    {				$query = $this->db->query("UPDATE location set location_name='".$txt_locality."',city_id='".$txt_city."' WHERE location_id='".$txt_locality_id."'");		if ($query !== FALSE)		{			return "Location has been Updated...";			// success so access your result		}		else		{			return "Location has not been Updated";			// do something with $this->db->error()		}		    }		    function delete_city($got_del_id)    {				$query = $this->db->query("DELETE FROM city WHERE city_id='".$got_del_id."'");        // return $query->result();		    }		    function delete_locality($got_del_id)    {				$query = $this->db->query("DELETE FROM location WHERE location_id='".$got_del_id."'");        // return $query->result();		    }		    function get_city_for_edit_mdl($got_edit_id)    {				$query = $this->db->query("SELECT * FROM city where city_id='".$got_edit_id."'");        return $query->result();		    }    function get_locality_for_edit_mdl($got_edit_id)    {				$query = $this->db->query("SELECT * FROM location where location_id='".$got_edit_id."'");        return $query->result();		    }
	/*--- for inserting news---*/
	function save_new_city($txt_city)	{
		$data=array('city_name'=>$txt_city);
		$this->db->insert('city',$data);
	}			function save_new_locality($txt_city,$txt_locality)	{
		$data=array('location_name'=>$txt_locality,'city_id'=>$txt_city);
		$this->db->insert('location',$data);
	}																	function save_store_account_group_child_do($group_name,$print_name,$user_id,$parent_group)	{
		$data=array('u_id'=>$user_id,'account_group_name'=>$group_name,'ag_print_name'=>$print_name,'parent_id'=>$parent_group);
		$this->db->insert('account_group_master',$data);
	}
    function fetch_account_group_in_tbodytbl_mdl($user_id)    {				$query = $this->db->query("CALL fetch_mstore_account_group_in_tbl_limit('1')");        return $query->result();		    }    function fetch_account_group_in_tbody_mdl($user_id)    {				$query = $this->db->query("CALL fetch_mstore_account_group_in_ag('".$user_id."')");        return $query->result();		    }	    function fetch_states_in_option_mdl()    {				$query = $this->db->query("CALL fetch_all_states()");        return $query->result();		    }		    function fetch_cities_in_option_mdl($state_id)    {				$query = $this->db->query("CALL fetch_cities_by_state('".$state_id."')");        return $query->result();    }		    function fetch_account_group_in_edit_mdl($user_id,$edit_id)    {				$query = $this->db->query("CALL fetch_mstore_accgroup_for_edit('".$edit_id."','".$user_id."')");        return $query->result();    }					    function save_store_account_details_do($user_id,$account_name,$alias,$print_name,$parent_group,$op_balance,$openBalRdo,$prev_yr_bal,$prevBalRdo,$state,$city,$type_of_dealer,$gstIn_uin,$address,$aadhaar_no,$it_pan,$e_mail,$mob_no,$fax,$transport,$pin_code,$tin,$tele_no,$contact_person,$cst,$lst,$service_tax_number,$lbt_no,$ie_no)    {				$query = $this->db->query("CALL save_store_account_details('".$user_id."','".$account_name."','".$alias."','".$print_name."','".$parent_group."','".$op_balance."','".$openBalRdo."','".$prev_yr_bal."','".$prevBalRdo."','".$state."','".$city."','".$type_of_dealer."','".$gstIn_uin."','".$address."','".$aadhaar_no."','".$it_pan."','".$e_mail."','".$mob_no."','".$fax."','".$transport."','".$pin_code."','".$tin."','".$tele_no."','".$contact_person."','".$cst."','".$lst."','".$service_tax_number."','".$lbt_no."','".$ie_no."')");        //return "Account detail has been saved..";		    }		    function update_store_account_group_do($group_name,$print_name,$user_id,$hide_id)    {				$query = $this->db->query("CALL update_store_account_group('".$group_name."','".$print_name."','".$user_id."','".$hide_id."')");    }    function update_store_account_group_child_do($group_name,$print_name,$parent_group,$user_id,$hide_id)    {				$query = $this->db->query("CALL update_store_account_group_child('".$group_name."','".$print_name."','".$parent_group."','".$user_id."','".$hide_id."')");    }				}
?>